# Dockerfile for E2E test runner
FROM mcr.microsoft.com/playwright:v1.56.1-noble

WORKDIR /app

# Install Node.js (if not already in base image)
# Playwright base image already has Node.js

# Copy package files
COPY package.json package-lock.json* ./

# Install dependencies including Playwright
RUN npm ci --legacy-peer-deps

# Install Playwright browsers
RUN npx playwright install chromium --with-deps

# Copy test files
COPY tests ./tests
COPY playwright.config.mjs ./

# Set environment for testing
ENV NODE_ENV=test
ENV CI=true

# Default command runs all Playwright tests
CMD ["npx", "playwright", "test"]
